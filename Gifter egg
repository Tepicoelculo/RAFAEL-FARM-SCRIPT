local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library", true))()

local window = library:CreateWindow("Phoenix Hub | by Alejandro")
local giftTab = window:CreateTab("üéÅ Gifting")

local player = game.Players.LocalPlayer
local selectedTarget = nil

-- Funci√≥n para actualizar la lista de jugadores
local function getPlayerList()
	local names = {}
	for _, plr in pairs(game.Players:GetPlayers()) do
		if plr ~= player then -- No incluir al local player
			table.insert(names, plr.Name)
		end
	end
	return names
end

-- Dropdown para seleccionar jugador
giftTab:CreateDropdown("Seleccionar jugador", getPlayerList(), function(value)
	selectedTarget = value
	library:Notify("Seleccionado: " .. selectedTarget, 2)
end)

-- ===========================
-- Contadores
-- ===========================

local function getTropicalShakeCount()
	local count = 0
	local character = player.Character or player.CharacterAdded:Wait()
	for _, item in ipairs(character:GetChildren()) do
		if item.Name == "Tropical Shake" then
			count += 1
		end
	end
	return count
end

local function getProteinEggCount()
	local count = 0
	local character = player.Character or player.CharacterAdded:Wait()
	for _, item in ipairs(character:GetChildren()) do
		if item.Name == "Huevo de Prote√≠na" or item.Name == "Protein Egg" then
			count += 1
		end
	end
	return count
end

local tropicalLabel = giftTab:CreateLabel("Tropical Shakes: " .. getTropicalShakeCount())
local proteinLabel = giftTab:CreateLabel("Protein Eggs: " .. getProteinEggCount())

-- ===========================
-- GIFT FUNCTIONS
-- ===========================

local function giftTropicalShake()
	if not selectedTarget then
		library:Notify("Selecciona un jugador", 3)
		return
	end

	local receiver = game.Players:FindFirstChild(selectedTarget)
	if not receiver then
		library:Notify("Jugador no encontrado.", 3)
		return
	end

	local character = player.Character or player.CharacterAdded:Wait()
	local shake = character:FindFirstChild("Tropical Shake")
	if not shake then
		library:Notify("No tienes Tropical Shakes.", 3)
		return
	end

	local args = {
		[1] = "giftTropicalShake",
		[2] = shake,
		[3] = receiver
	}

	pcall(function()
		player:WaitForChild("muscleEvent"):FireServer(unpack(args))
	end)

	task.delay(1, function()
		tropicalLabel:Update("Tropical Shakes: " .. getTropicalShakeCount())
	end)

	library:Notify("Shake enviado a " .. receiver.Name .. " ‚úî", 2)
end

local function giftProteinEgg()
	if not selectedTarget then
		library:Notify("Selecciona un jugador", 3)
		return
	end

	local receiver = game.Players:FindFirstChild(selectedTarget)
	if not receiver then
		library:Notify("Jugador no encontrado.", 3)
		return
	end

	local character = player.Character or player.CharacterAdded:Wait()
	local egg = character:FindFirstChild("Huevo de Prote√≠na") or character:FindFirstChild("Protein Egg")
	if not egg then
		library:Notify("No tienes Protein Eggs.", 3)
		return
	end

	local args = {
		[1] = "giftProteinEgg",
		[2] = egg,
		[3] = receiver
	}

	pcall(function()
		player:WaitForChild("muscleEvent"):FireServer(unpack(args))
	end)

	task.delay(1, function()
		proteinLabel:Update("Protein Eggs: " .. getProteinEggCount())
	end)

	library:Notify("Egg enviado a " .. receiver.Name .. " ‚úî", 2)
end

-- ===========================
-- BOTONES GIFT
-- ===========================

giftTab:CreateButton("Gift Tropical Shakes", giftTropicalShake)
giftTab:CreateButton("Gift Protein Eggs", giftProteinEgg)

-- ===========================
-- AUTO EGG TOGGLE
-- ===========================

local autoEggEnabled = false
local function startAutoEgg()
	task.spawn(function()
		while autoEggEnabled do
			local character = player.Character or player.CharacterAdded:Wait()
			local egg = character:FindFirstChild("Huevo de Prote√≠na") or character:FindFirstChild("Protein Egg")
			if egg then
				local args = {
					[1] = "proteinEgg",
					[2] = egg
				}
				pcall(function()
					player:WaitForChild("muscleEvent"):FireServer(unpack(args))
				end)
			end
			task.wait(0.1)
		end
	end)
end

giftTab:CreateToggle("Auto Egg", function(state)
	autoEggEnabled = state
	if state then
		startAutoEgg()
		library:Notify("Auto Egg activado ‚úÖ", 2)
	else
		library:Notify("Auto Egg desactivado ‚ùå", 2)
	end
end)
